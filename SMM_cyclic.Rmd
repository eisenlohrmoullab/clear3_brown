---
title: "SMM_cyclic"
author: "Anisha Nagpal"
date: "`r Sys.Date()`"
output: html_document
---

# Libraries and functions

```{r}
library(mgcv)
library(tidyverse)
library(dplyr)
library(menstrualcycleR)
library(gam.hp)
library(marginaleffects)
library(gmodels)
library(MASS)
library(zoo)
library(purrr)
library(ggstatsplot)
library(haven)

conflicted::conflicts_prefer(
  dplyr::filter, 
  tidyr::complete, 
  tidyr::expand, 
  dplyr::lag, 
  dplyr::select
)
  

func_dir <- "SMM functions"

list.files(func_dir, pattern = "\\.[rR]$", full.names = TRUE) %>% 
  walk(source)

cat("âœ… All SMM function scripts sourced!")
```




# Modeling 

## Steps

### Step 1: preprocess outcome/ subset by phase 

```{r}

df = preprocess_outcome(df, "Oura_Activity_steps")
#2. subset your dataset, so you have at least 5 observations in the luteal phase, and 5 in the follicular phase for each id 

steps <- subset_by_phase_cyclic(
  data = df,
  outcome = "Oura_Activity_steps",
  time_var = "cyclic_time_impute",
  min_obs = 3
)

steps_data_subset <-steps$data_subset

```

### Step 2:  run SMM

```{r}
ressteps_menses <- run_smm_cyclic(
  data = steps_data_subset,
  outcome = "Oura_Activity_steps",
  g = 2:4, #this will check for solutions for 2-5 groups
  d_inter = 20, # number of random starts
  k_smooth = 10, # number of knots for the cyclic spline
  plot = F, # whether to plot the mean group trajectories
  centering = "menses", #can change this to "ovulation" 
  save_dir = "output"
)


ressteps_ov <- run_smm_cyclic(
  data = steps_data_subset,
  outcome = "Oura_Activity_steps",
  g = 2:4, #this will check for solutions for 2-5 groups
  d_inter = 20, # number of random starts
  k_smooth = 10, # number of knots for the cyclic spline
  plot = F, # whether to plot the mean group trajectories
  centering = "ovulation", #can change this to "ovulation" 
  save_dir = "output"
)
```

### create percent cycle variable for plotting
```{r}
# create percent cycle variable for plotting later
steps_data_subset$cyclic_perc = ((steps_data_subset$cyclic_time_impute + 1) / 2) # scale -1 to 1 to 0 to 1

steps_data_subset$cyclic_5perc = round(steps_data_subset$cyclic_perc / 0.05) * 0.05 # round to nearest 5 percent

#steps_data_subset %>% dplyr::select(c(id, daterated, cyclic_time_impute, cyclic_perc, cyclic_5perc)) # view to check
```

### Step 3: compare BIC

```{r}
steps_bic_result_menses <- compare_bic_cyclic(
  data = steps_data_subset,
  outcome = "Oura_Activity_steps",
  centering = "menses",
  smm_results = ressteps_menses, #put in the result object from step 3
  save_dir = "output"
)

steps_bic_result_ov <- compare_bic_cyclic(
  data = steps_data_subset,
  outcome = "Oura_Activity_steps",
  centering = "ovulation",
  smm_results = ressteps_ov, #put in the result object from step 3
  save_dir = "output"
)

```

### Step 4: Model Subgroup Membership as a Moderator

```{r}
stepsgams_menses = model_plot_modx_gam_cyclic(
  data = steps_data_subset,
  outcome = "Oura_Activity_steps",
  smm_result = ressteps_menses, #put in the result object from step 3
  centering = "menses",#can change this to "ovulation" 
  save_dir = "output",
)


stepsgams_ov = model_plot_modx_gam_cyclic(
  data = steps_data_subset,
  outcome = "Oura_Activity_steps",
  smm_result = ressteps_ov, #put in the result object from step 3
  centering = "ovulation",#can change this to "ovulation" 
  save_dir = "output",
)



stepsgams_menses$gcv_plot
```

### trait comparisons 

`
```{r}
# This line reads in the CSV file containing the group classifications
stepsgroups = read.csv("output/20251119/Oura_Activity_steps/menses_centered/Oura_Activity_steps_g2_class.csv")

# This line reads in the RDS file containing the trait scales
trait = readRDS("~/Library/CloudStorage/Box-Box/00 - CLEAR Lab (Locked Folders)/02 - Data Management, Analysis, and Papers/Studies_Projects/CLEARCOMBINED_projects/00_CLEARTRIALS_harmonization_merging_notes/clear123_trait_scales.rds")

# This line merges the trait scales with the group classifications based on the "id" column
steps_trait_sub = merge(trait, stepsgroups, by = "id")

names(steps_trait_sub)

# This line specifies the path where the trait comparison results will be saved
trait_path = "output/20251119/Oura_Activity_steps/trait_comparisons"
```
 # #lifetimedx_hxbipolar1", "currentdx_bipolar1", "lifetimedx_hxbipolar2", "currentdx_bipolar2",
  # "currentdx_cyclothymic", "lifetimedx_hxothbipolar", "currentdx_othbipolar", "lifetimedx_hxbipolarAMC", "currentdx_bipAMC",
  # "lifetimedx_hxSMIbipolar", "currentdx_sindbip", "lifetimedx_hxMDD", "currentdx_MDD", "lifetimedx_hxPDD",
  # "currentdx_PDD", "lifetimedx_hxothDD", "currentdx_othDD", "lifetimedx_hxDDAMC", "currentdx_DDAMC",
  # "lifetimedx_hxSMIDD", "currentdx_SiDD", "lifetimedx_hxSchizophrenia", "currentdx_Schizophrenia", "lifetimedx_hxschizphreniform",
  # "currentdx_schizophreniform", "lifetimedx_hxschzaff", "currentdx_schizoaffective", "lifetimedx_hxdelusionaldo", "currentdx_delusionaldo",
  # "lifetimedx_hxbriefpsychoticdo", "currentdx_briefpsychoticdo", "lifetimedx_hxpsyotamc", "currentdx_psychoticAMC", "lifetimedx_hxsiPD",
  # "currentdx_sipsychoticdo", "lifetimedx_hxothpsy", "currentdx_otherpsychotic", "lifetimedx_hxSUDalc", "currentdx_SUDalc",
  # "lifetimedx_hxSUDsha", "currentdx_SUDsha", "lifetimedx_hxSUDMJ", "currentdx_SUDmj", "lifetimedx_hxSUDstim",
  # "currentdx_SUDstim", "lifetimedx_hxSUDopioid", "currentdx_SUDopioid", "lifetimedx_hxSUDPCP", "currentdx_SUDpcp",
  # "lifetimedx_hxSUDothhall", "currentdx_SUDothhall", "lifetimedx_hxSUDinh", "currentdx_SUDinhal", "lifetimedx_hxSUDother",
  # "currentdx_SUDother", "lifetimedx_hxpanicDO", "currentdx_PanicDO", "lifetimedx_hxagora", "currentdx_Agoraphobia",
  # "lifetimedx_hxSAD", "currentdx_SAD", "lifetimedx_hxphobia", "currentdx_Phobi", "lifetimedx_hxGAD",
  # "currentdx_GAD", "lifetimedx_hxotheranx", "currentdx_OtherAnx", "lifetimedx_hxanxAMC", "currentdx_AnxAMC",
  # "lifetimedx_hxsiAD", "currentdx_siANX", "lifetimedx_hxOCD", "currentdx_OCD", "lifetimedx_hxothspOCD",
  # "currentdx_otherOC", "lifetimedx_hxOCDAMC", "currentdx_OCDAMC", "lifetimedx_hxSIOCD", "currentdx_siOCD",
  # "lifetimedx_hxAN", "currentdx_AN", "lifetimedx_hxBN", "currentdx_BN", "lifetimedx_hxBED",
  # "currentdx_BED", "lifetimedx_hxothereat", "currentdx_otheat", "currentdx_ADHD", "currentdx_AcuteStressDO",
  # "lifetimedx_hxPTSD", "currentdx_PTSD", "currentdx_AdjustmentDO", "lifetimedx_hxothertrauma", "currentdx_Othertrauma",
  # "currentdx_PMDD_prov", "currentdx_BPD", "gender", "gender_other", "age",
  
  
  
#############################################
######### TWO GROUP IDAS (BASELINE) COMPARISONS #########
#############################################

```{r}
# 1. Create the Master List of Dependent Variables
dv_list <- c(
  "iip_1_domctrl",
  "iip_2_vindselfcent", "iip_3_colddist", "iip_4_socinhib", "iip_5_nonassert", "iip_7_selfsac",
  "iip_8_intrusneedy", "iip_7_overaccom", "iip_total","number_children",
  "caffeine", "ASIQ_total", "BHS_total",
  "IDASI_GENDEP.mean", "IDASI_dys.mean", "IDASI_lass.mean", "IDASI_insom.mean", "IDASI_sui.mean",
  "IDASI_apploss.mean", "IDASI_appgain.mean", "IDASI_wb.mean", "IDASI_illtemp.mean", "IDASI_mania.mean",
  "IDASI_euph.mean", "IDASI_panic.mean", "IDASI_socanx.mean", "IDASI_claus.mean", "IDASI_traumint.mean",
  "IDASI_traumav.mean", "IDASI_check.mean", "IDASI_ord.mean", "IDASI_clean.mean", "BAM_mean", "INQ_perceivedburd",
  "INQ_thwartbelong", "BFNE_total", "acssfad_total", "Entrap_ext", "Entrap_int",
  "Entrap_tot", "MAPS_SocMot", "MAPS_MotEffort", "MAPS_Pleasure", "MAPS_Total",
  "STICSA_COG", "STICSA_SOM", "STICSA_total", "promis_total", "BITe_total",
  "POMS_TEN", "POMS_ANG", "POMS_FAT", "POMS_DEP", "POMS_ERA",
  "POMS_VIG", "POMS_CON", "POMS_TMD", "CFI_alt", "CFI_ctrl",
  "PSS_total", "EDE_restr", "EDE_eatconc", "EDE_shapeconc", "EDE_wtconc",
  "numfullatt", "bmi", "age")
  
 

# 2. Loop through each variable
for (var in dv_list) {
  
  # --- A. Run and Print the Kruskal-Wallis Test ---
  # We create a dynamic formula (e.g., IDASI_dys ~ class)
  kruskal_formula <- as.formula(paste(var, "~ class"))
  
  # Print a separator and the test results to the console
  cat("\n--------------------------------------\n")
  cat("ANALYSIS FOR:", var, "\n")
  print(kruskal.test(kruskal_formula, data = steps_trait_sub))
  
  # --- B. Generate and Print the Plot ---
  # Note: We use !!rlang::sym(var) to tell ggplot to treat the string as a column name
  p <- ggbetweenstats(
    data  = steps_trait_sub,
    x     = class,
    y     = !!rlang::sym(var), 
    title = paste("Distribution of", var, "across latent groups"),
    messages = FALSE,             # Set to TRUE if you want stats text in console
    pairwise.comparisons = TRUE,
    pairwise.display = "significant",
    p.adjust.method = "none",
    type = "nonparametric"
  )
  
  # Explicitly print the plot to make it render in the Rmd output
  print(p)
}
```



```{r}
# 1. Create the summary dataframe for ALL medications
df_meds_summary <- df %>%
  dplyr::select(id, SSRI, SNRI, stim_YN, bupropion_YN, SSAD_YN, bzd_YN, moodstabilizer_YN, antipsychotic_YN) %>%
  group_by(id) %>%
  summarize(
    # Apply the function to all columns selected above (except 'id', which is the grouping var)
    across(
      .cols = everything(),
      .fns  = ~ ifelse(mean(.x, na.rm = TRUE) > 0, 1, 0)
    )
  ) %>%
  ungroup()

# 2. Join back to the main dataset
steps_trait_sub <- left_join(steps_trait_sub, df_meds_summary, by = "id")

```

```{r}
# ---------------------------------------------------------
# 1. Define the List of Diagnostic Variables
# ---------------------------------------------------------
diag_vars <- c(
  "lifetimedx_hxbipolar1", "currentdx_bipolar1", "lifetimedx_hxbipolar2", "currentdx_bipolar2",
  "currentdx_cyclothymic", "lifetimedx_hxothbipolar", "currentdx_othbipolar", "lifetimedx_hxbipolarAMC", "currentdx_bipAMC",
  "lifetimedx_hxSMIbipolar", "currentdx_sindbip", "lifetimedx_hxMDD", "currentdx_MDD", "lifetimedx_hxPDD",
  "currentdx_PDD", "lifetimedx_hxothDD", "currentdx_othDD", "lifetimedx_hxDDAMC", "currentdx_DDAMC",
  "lifetimedx_hxSMIDD", "currentdx_SiDD", "lifetimedx_hxSchizophrenia", "currentdx_Schizophrenia", "lifetimedx_hxschizphreniform",
  "currentdx_schizophreniform", "lifetimedx_hxschzaff", "currentdx_schizoaffective", "lifetimedx_hxdelusionaldo", "currentdx_delusionaldo",
  "lifetimedx_hxbriefpsychoticdo", "currentdx_briefpsychoticdo", "lifetimedx_hxpsyotamc", "currentdx_psychoticAMC", "lifetimedx_hxsiPD",
  "currentdx_sipsychoticdo", "lifetimedx_hxothpsy", "currentdx_otherpsychotic", "lifetimedx_hxSUDalc", "currentdx_SUDalc",
  "lifetimedx_hxSUDsha", "currentdx_SUDsha", "lifetimedx_hxSUDMJ", "currentdx_SUDmj", "lifetimedx_hxSUDstim",
  "currentdx_SUDstim", "lifetimedx_hxSUDopioid", "currentdx_SUDopioid", "lifetimedx_hxSUDPCP", "currentdx_SUDpcp",
  "lifetimedx_hxSUDothhall", "currentdx_SUDothhall", "lifetimedx_hxSUDinh", "currentdx_SUDinhal", "lifetimedx_hxSUDother",
  "currentdx_SUDother", "lifetimedx_hxpanicDO", "currentdx_PanicDO", "lifetimedx_hxagora", "currentdx_Agoraphobia",
  "lifetimedx_hxSAD", "currentdx_SAD", "lifetimedx_hxphobia", "currentdx_Phobi", "lifetimedx_hxGAD",
  "currentdx_GAD", "lifetimedx_hxotheranx", "currentdx_OtherAnx", "lifetimedx_hxanxAMC", "currentdx_AnxAMC",
  "lifetimedx_hxsiAD", "currentdx_siANX", "lifetimedx_hxOCD", "currentdx_OCD", "lifetimedx_hxothspOCD",
  "currentdx_otherOC", "lifetimedx_hxOCDAMC", "currentdx_OCDAMC", "lifetimedx_hxSIOCD", "currentdx_siOCD",
  "lifetimedx_hxAN", "currentdx_AN", "lifetimedx_hxBN", "currentdx_BN", "lifetimedx_hxBED",
  "currentdx_BED", "lifetimedx_hxothereat", "currentdx_otheat", "currentdx_ADHD", "currentdx_AcuteStressDO",
  "lifetimedx_hxPTSD", "currentdx_PTSD", "currentdx_AdjustmentDO", "lifetimedx_hxothertrauma", "currentdx_Othertrauma",
  "currentdx_PMDD_prov", "currentdx_BPD"
)

diag_vars <- c("SSRI", "SNRI", "stim_YN", "bupropion_YN", "SSAD_YN", "bzd_YN", "moodstabilizer_YN", "antipsychotic_YN")

# ---------------------------------------------------------
# 2. CLEANING: Fix "2"s and Convert to Factors
# ---------------------------------------------------------
for (var in diag_vars) {
  # Only proceed if the variable actually exists in your dataframe
  if (var %in% names(steps_trait_sub)) {
    
    # Step A: Ensure it is treated as a number first (strips away labels)
    # We use suppressWarnings because converting factors to numbers sometimes warns
    vals <- suppressWarnings(as.numeric(as.character(steps_trait_sub[[var]])))
    
    # Step B: Find any 2s and turn them into 1s
    # (Assuming 0 = No, 1 = Yes, and 2 was an error for Yes)
    vals[vals == 2] <- 1
    
    # Step C: Save it back as a FACTOR (Required for ggbarstats)
    # We exclude NAs from the levels so they don't show up as a category
    steps_trait_sub[[var]] <- factor(vals, levels = c(0, 1), labels = c("No", "Yes"))
  }
}

# Ensure grouping variable is also a factor
steps_trait_sub$class <- as.factor(steps_trait_sub$class)


# ---------------------------------------------------------
# 3. RUN THE LOOP: Chi-Square + Plots
# ---------------------------------------------------------
for (var in diag_vars) {
  
  try({
    # Skip if variable is missing from dataframe
    if (!var %in% names(steps_trait_sub)) next 
    
    # Skip if everyone is "No" (no variance), otherwise test crashes
    # We check the length of unique values ignoring NAs
    if(length(unique(na.omit(steps_trait_sub[[var]]))) < 2) {
      cat("\nSKIPPING", var, "- No variance (e.g., 0 people have this diagnosis)\n")
      next 
    }
    
    cat("\n--------------------------------------\n")
    cat("DIAGNOSTIC COMPARISON FOR:", var, "\n")
    
    # --- Chi Square Test ---
    tbl <- table(steps_trait_sub$class, steps_trait_sub[[var]])
    print(tbl) 
    print(chisq.test(tbl))
    
    # --- Plot ---
    p <- ggbarstats(
      data = steps_trait_sub,
      x = !!rlang::sym(var), 
      y = class,              
      title = paste("Prevalence of", var, "by Class"),
      label = "both",         
      messages = FALSE
    )
    print(p)
    
  }, silent = FALSE)
}

```










# No group differences in race/ethnicity
```{r}
steps_trait_sub <- steps_trait_sub %>%
  mutate(race_eth_analysis_label = haven::as_factor(race_eth_analysis))

# Ensure factors
steps_trait_sub$class <- as.factor(steps_trait_sub$class)
steps_trait_sub$race_eth_analysis <- as.factor(steps_trait_sub$race_eth_analysis)
# Filter & drop unused levels
steps_race_eth <- steps_trait_sub %>% 
  filter(!is.na(class), !is.na(race_eth_analysis)) %>%
  droplevels()
# Create table
tab <- table(steps_race_eth$class, steps_race_eth$race_eth_analysis)
print(tab)
# Run test
res_steps_race_eth <- stats::fisher.test(tab)
print(res_steps_race_eth)

res_steps_race_eth = capture.output(res_steps_race_eth)

# Print to console
print(res_steps_race_eth)

#writeLines(res_steps_race_eth, file.path(trait_path, "race_eth.txt"))
1
```


```{r}

         
ggbarstats(
  data  = steps_trait_sub,
  x     = race_eth_analysis_label,
  y     = class,
  title = "Distribution of race and ethnicity across latent groups", messages = T, pairwise_comparisons = T, pairwise.display = "significant", p.adjust.method = "none", type = "nonparametric")
ggsave(file.path(trait_path, "race_eth_labeled.png"))

ggbarstats(
  data  = steps_trait_sub,
  x     = race_eth_analysis,
  y     = class,
  title = "Distribution of race and ethnicity across latent groups", messages = T, pairwise_comparisons = T, pairwise.display = "significant", p.adjust.method = "none", type = "nonparametric")
ggsave(file.path(trait_path, "race_eth.png"))

steps_trait_sub %>% dplyr::select(id, class, race_eth_analysis)
```






```{r}
steps_trait_sub$everpregyn = as.numeric(steps_trait_sub$everpregyn)
CrossTable(steps_trait_sub$class, steps_trait_sub$everpregyn, fisher = TRUE, chisq = TRUE, expected = TRUE, format = "SPSS")

# investigate why ever
```

```{r}
# 1. Define the Daily Variables (The "Top" List)
# These are the ones that need to be averaged.
vars_daily <- c("DRSP1_depblue", "DRSPx_cramps", "DRSP4_anxious", 
                "DRSP7b_irritable", "PANAS_happy", "DRSPx_notenjoy",
                "physicalpain", "numdrinks_yest", "DRSP7_angirr")

# 3. Run the Pipeline
steps_data_trait2_sub <- df %>%
  group_by(id) %>%
  summarize(
    # A. Loop through the daily vars -> calculate mean -> add ".m"
    across(all_of(vars_daily), ~ mean(.x, na.rm = TRUE), .names = "{.col}.m")
   
  ) %>%
  ungroup()

# 4. Join with Groups
stepsgroups$id <- as.factor(stepsgroups$id)
steps_data_trait2_sub$id <- as.factor(steps_data_trait2_sub$id)

steps_data_trait2_sub <- left_join(stepsgroups, steps_data_trait2_sub, by = "id")

# 5. Final Cleanup (Optional, but ensures no duplicates exist)
steps_data_trait2_sub <- unique(steps_data_trait2_sub)
```


```{r}

kruskal.test(DRSP1_depblue.m ~ class, data = steps_data_trait2_sub)

ggbetweenstats(
  data  = steps_data_trait2_sub,
  x     = class,
  y     = DRSP1_depblue.m,
  title = "Distribution of Mean Depressed Mood across latent groups", messages = T,pairwise_comparisons = T, pairwise.display = "significant", p.adjust.method = "none", type = "nonparametric", results.subtitle = T, var.equal = F
)

```


```{r}
kruskal.test(DRSPx_cramps.m ~ class, data = steps_data_trait2_sub)

ggbetweenstats(
  data  = steps_data_trait2_sub,
  x     = class,
  y     = DRSPx_cramps.m,
  title = "Distribution of Mean Cramps across latent groups", messages = T,pairwise_comparisons = T, pairwise.display = "significant", p.adjust.method = "none", type = "nonparametric", results.subtitle = T, var.equal = F
)
```


```{r}

# test = kruskal.test(DRSP4_anxious.m ~ class, data = steps_data_trait2_sub)
# test = capture.output(test)
#writeLines(test, file.path(trait_path, "DRSP4_anxious.m.txt"))
ggbetweenstats(
  data  = steps_data_trait2_sub,
  x     = class,
  y     = DRSP4_anxious.m,
  title = "Distribution of Mean Anxiety across latent groups", messages = T,pairwise_comparisons = T, pairwise.display = "significant", p.adjust.method = "none", type = "nonparametric", results.subtitle = T, var.equal = F
)
# ggsave(file.path(trait_path, "DRSP4_anxious.m.png"))
```

```{r}
kruskal.test(DRSP7b_irritable.m ~ class, data = steps_data_trait2_sub)

ggbetweenstats(
  data  = steps_data_trait2_sub,
  x     = class,
  y     = DRSP7b_irritable.m,
  title = "Distribution of Mean Irritability across latent groups", messages = T,pairwise_comparisons = T, pairwise.display = "significant", p.adjust.method = "none", type = "nonparametric", results.subtitle = T, var.equal = F
)
```


```{r}
kruskal.test(DRSP7_angirr.m ~ class, data = steps_data_trait2_sub)

ggbetweenstats(
  data  = steps_data_trait2_sub,
  x     = class,
  y     = DRSP7_angirr.m,
  title = "Distribution of Mean Anger/Irritability across latent groups", messages = T,pairwise_comparisons = T, pairwise.display = "significant", p.adjust.method = "none", type = "nonparametric", results.subtitle = T, var.equal = F
)
```


```{r}

test = kruskal.test(PANAS_happy.m ~ class, data = steps_data_trait2_sub)
test = capture.output(test)
writeLines(test, file.path(trait_path, "panas_happy.m.txt"))
ggbetweenstats(
  data  = steps_data_trait2_sub,
  x     = class,
  y     = PANAS_happy.m,
  title = "Distribution of Mean Happiness across latent groups", messages = T,pairwise_comparisons = T, pairwise.display = "significant", p.adjust.method = "none", type = "nonparametric", results.subtitle = T, var.equal = F
)
ggsave(file.path(trait_path, "panas_happy.m.png"))
```


```{r}

kruskal.test(DRSPx_notenjoy.m ~ class, data = steps_data_trait2_sub)

ggbetweenstats(
  data  = steps_data_trait2_sub,
  x     = class,
  y     = DRSPx_notenjoy.m,
  title = "Distribution of Mean Not Enjoy across latent groups", messages = T,pairwise_comparisons = T, pairwise.display = "significant", p.adjust.method = "none", type = "nonparametric", results.subtitle = T, var.equal = F
)
```


```{r}
test = kruskal.test(numdrinks_yest.m ~ class, data = steps_data_trait2_sub)
test = capture.output(test)
writeLines(test, file.path(trait_path, "numdrinks.m.txt"))
ggbetweenstats(
  data  = steps_data_trait2_sub,
  x     = class,
  y     = numdrinks_yest.m,
  title = "Distribution of Mean Number of Drinks across latent groups", messages = T,pairwise_comparisons = T, pairwise.display = "significant", p.adjust.method = "none", type = "nonparametric", results.subtitle = T, var.equal = F
)

ggsave(file.path(trait_path, "mean_drinks.png"))
```

